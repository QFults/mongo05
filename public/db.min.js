let db; const request = indexedDB.open("list", 1); request.onupgradeneeded = (e => { (db = e.target.result).createObjectStore("pending", { autoIncrement: !0 }) }), request.onsuccess = (e => { db = e.target.result, navigator.onLine && checkDatabase() }), request.onerror = (e => { console.log(e.target.errorCode) }); const saveItem = e => { db.transaction(["pending"], "readwrite").objectStore("pending").add(e) }, checkDatabase = () => { const e = db.transaction(["pending"], "readwrite").objectStore("pending").getAll(); e.onsuccess = (() => { e.result.length > 0 && axios.post("/api/items", e.result).then(() => { db.transaction(["pending"], "readwrite").objectStore("pending").clear() }) }) }; window.addEventListener("online", checkDatabase);